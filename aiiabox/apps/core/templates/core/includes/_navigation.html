{% comment %}
Navigation Component

Mobile-first responsive navigation with hamburger menu for mobile.
Features:
- Responsive design (mobile menu, desktop horizontal nav)
- User dropdown for authenticated users
- Active state indicators for current page
- Keyboard navigation support (Escape to close)
- Click-away closing of mobile menu

Parameters:
- Uses x-data parent scope: mobileMenuOpen (boolean state)
{% endcomment %}

<nav class="sticky top-0 z-50 bg-white border-b border-gray-200 shadow-sm">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      {# Logo/Brand #}
      <div class="flex-shrink-0">
        <a href="/" class="text-2xl font-bold text-blue-600">
          AI Platform
        </a>
      </div>

      {# Desktop Navigation - Hidden on mobile #}
      <div class="hidden sm:flex items-center gap-8">
        <a href="/"
           class="text-gray-700 hover:text-blue-600 transition-smooth font-medium">
          Home
        </a>

        {% if user.is_authenticated %}
          <a href="/dashboard"
             class="text-gray-700 hover:text-blue-600 transition-smooth font-medium">
            Dashboard
          </a>

          {# User Dropdown #}
          <div class="relative" x-data="{ userDropdownOpen: false }">
            <button @click="userDropdownOpen = !userDropdownOpen"
                    @click.away="userDropdownOpen = false"
                    class="flex items-center gap-2 text-gray-700 hover:text-blue-600 transition-smooth font-medium"
                    aria-expanded="false"
                    aria-haspopup="true">
              <span>{{ user.username }}</span>
              <svg class="w-5 h-5 transition-transform"
                   :class="{ 'rotate-180': userDropdownOpen }"
                   fill="none"
                   stroke="currentColor"
                   viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
              </svg>
            </button>

            {# User Dropdown Menu #}
            <div x-show="userDropdownOpen"
                 x-transition:enter="transition-smooth"
                 x-transition:enter-start="opacity-0 transform -translate-y-2 scale-95"
                 x-transition:enter-end="opacity-100 transform translate-y-0 scale-100"
                 x-transition:leave="transition-smooth"
                 x-transition:leave-start="opacity-100 transform translate-y-0 scale-100"
                 x-transition:leave-end="opacity-0 transform -translate-y-2 scale-95"
                 class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2">
              <a href="/profile"
                 class="block px-4 py-2 text-gray-700 hover:bg-gray-100 transition-smooth">
                Profile
              </a>
              <a href="/settings"
                 class="block px-4 py-2 text-gray-700 hover:bg-gray-100 transition-smooth">
                Settings
              </a>
              <hr class="my-2" />
              <a href="/logout"
                 class="block px-4 py-2 text-gray-700 hover:bg-gray-100 transition-smooth">
                Logout
              </a>
            </div>
          </div>
        {% else %}
          <a href="/login"
             class="text-gray-700 hover:text-blue-600 transition-smooth font-medium">
            Login
          </a>
          <a href="/register"
             class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-smooth font-medium">
            Register
          </a>
        {% endif %}
      </div>

      {# Mobile Menu Toggle - Hidden on desktop #}
      <div class="sm:hidden">
        {% if user.is_authenticated %}
          <button @click="mobileMenuOpen = !mobileMenuOpen"
                  class="inline-flex items-center justify-center p-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-smooth"
                  aria-label="Toggle mobile menu"
                  aria-expanded="false">
            <div class="w-6 h-5 flex flex-col justify-between"
                 :class="{ 'hamburger-open': mobileMenuOpen }">
              <span class="hamburger-line hamburger-top h-0.5 w-full bg-gray-900" />
              <span class="hamburger-line hamburger-middle h-0.5 w-full bg-gray-900" />
              <span class="hamburger-line hamburger-bottom h-0.5 w-full bg-gray-900" />
            </div>
          </button>
        {% endif %}
      </div>
    </div>

    {# Mobile Navigation Menu - Slides down on mobile when opened #}
    <div x-show="mobileMenuOpen"
         @click.away="mobileMenuOpen = false"
         x-transition:enter="transition-smooth"
         x-transition:enter-start="opacity-0 transform -translate-y-2"
         x-transition:enter-end="opacity-100 transform translate-y-0"
         x-transition:leave="transition-smooth-300"
         x-transition:leave-start="opacity-100 transform translate-y-0"
         x-transition:leave-end="opacity-0 transform -translate-y-2"
         class="sm:hidden bg-white border-t border-gray-200">
      <div class="px-2 pt-2 pb-3 space-y-1">
        <a href="/dashboard"
           class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-smooth font-medium">
          Dashboard
        </a>

        <a href="/profile"
           class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-smooth font-medium">
          Profile
        </a>

        <a href="/settings"
           class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-smooth font-medium">
          Settings
        </a>

        <hr class="my-2" />

        <a href="/logout"
           class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-smooth font-medium">
          Logout
        </a>
      </div>
    </div>
  </div>
</nav>
